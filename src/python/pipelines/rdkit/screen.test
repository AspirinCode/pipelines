// Automated pipeline test specification.

[

    version = 1,

    // Testing screen.py reading and writing files using sdf
    test_dhfr_data_sdf = [

        command: '''python -m pipelines.rdkit.screen
                 -i ../../data/dhfr_3d.sdf.gz -o output -of sdf
                 --qsmiles 'C1N=C(C2=CC=CC=C2)C2=CC=CC=C2C2=C1C=NC(NC1=CC=CC=C1)=N2'
                 --simmin 0.45 -if sdf --meta''',

        see: [ 'Found [1-9]\\d+ similar molecules' ],

        creates: [ 'output.sdf.gz',
                   'output_metrics.txt' ],

        metrics: [ 'RDKitScreen': '756',
                   '__InputCount__': '756',
                   '__OutputCount__': '[1-9]\\d+' ],

    ],

    // Testing screen.py reading and writing files using json
    test_nci100_data_json = [

        command: '''python -m pipelines.rdkit.screen
                 -i ../../data/nci100.data.gz -o output -of json
                 --qsmiles 'C1N=C(C2=CC=CC=C2)C2=CC=CC=C2C2=C1C=NC(NC1=CC=CC=C1)=N2'
                 --simmin 0.45 -if json --meta''',

        see: [ 'Found [1-9]\\d+ similar molecules' ],

        creates: [ 'output.data.gz',
                   'output.metadata',
                   'output_metrics.txt' ],

        metrics: [ 'RDKitScreen': '100',
                   '__InputCount__': '100',
                   '__OutputCount__': '[1-9]\\d+' ],

    ],

    // Testing screen.py reading and writing files using thin sdf
    test_dhfr_data_sdf_thin = [

        command: '''python -m pipelines.rdkit.screen
                 -i ../../data/dhfr_3d.sdf.gz -o output -of sdf
                 --qsmiles 'C1N=C(C2=CC=CC=C2)C2=CC=CC=C2C2=C1C=NC(NC1=CC=CC=C1)=N2'
                 --simmin 0.45 -if sdf --thin --meta''',

        see: [ 'Found [1-9]\\d+ similar molecules' ],

        creates: [ 'output.sdf.gz' ],

        metrics: [ 'RDKitScreen': '756',
                   '__InputCount__': '756',
                   '__OutputCount__': '[1-9]\\d+' ],

    ],

    // Testing screen.py reading and writing files using thin json
    test_nci100_data_json_thin = [

        command: '''python -m pipelines.rdkit.screen
                 -i ../../data/nci100.data.gz -o output -of json
                 --qsmiles 'C1N=C(C2=CC=CC=C2)C2=CC=CC=C2C2=C1C=NC(NC1=CC=CC=C1)=N2'
                 --simmin 0.45 -if json --thin --meta''',

        see: [ 'Found [1-9]\\d+ similar molecules' ],

        creates: [ 'output.data.gz',
                   'output.metadata',
                   'output_metrics.txt' ],

        metrics: [ 'RDKitScreen': '100',
                   '__InputCount__': '100',
                   '__OutputCount__': '[1-9]\\d+' ],

    ],

]
